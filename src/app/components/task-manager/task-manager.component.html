<!-- Login Screen -->
@if(!isLoggedIn) {
<app-admin-login (isLoggedEventIn)="handleLogin($event)"></app-admin-login>
}

<!-- Main Content -->
@if(isLoggedIn){
<div class="min-h-screen bg-gradient-to-br from-primary-900 via-primary-700 to-accent-700 text-white">
  <!-- Navbar -->
  <nav class="bg-white/10 backdrop-blur-md border-b border-white/20">
    <div class="max-w-7xl mx-auto px-6 flex justify-between items-center h-16">
      <h1 class="text-2xl font-bold tracking-wide text-white">Task Manager</h1>
      <button (click)="logout()"
        class="px-5 py-2 rounded-xl bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-400 hover:to-pink-500 text-white font-semibold shadow-lg transition-all">
        Logout
      </button>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 py-6 space-y-8">

    <div class="bg-white/10 backdrop-blur-lg border border-white/20 shadow-xl rounded-2xl p-8">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-white">ðŸ“‹ Tasks / Projects</h2>
        <span class="text-sm text-gray-300">
          <span class="pi pi-file-excel">
            <a href="https://docs.google.com/spreadsheets/d/1Kyhu8jYOwnpFXciPpF98rJU_yhfzn_ltKTtzovF8FN0/edit?usp=sharing"
              class="curspr-pointer">ðŸ“©</a></span>
          {{ taskItems.length }} total</span>
      </div>
      <div class="overflow-x-auto rounded-lg border border-white/20">
        <table class="w-full text-left border-collapse">
          <thead class="bg-white/10 text-gray-200 uppercase text-xs tracking-wider">
            <tr>
              <th class="px-6 py-4">Task</th>
              <th class="px-6 py-4">Start</th>
              <th class="px-6 py-4">Deadline</th>
              <th class="px-6 py-4">Assignee</th>
              <th class="px-6 py-4">Client</th>
              <th class="px-6 py-4">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let task of taskItems; let i = index"
              class="transition-all duration-300 hover:bg-white/20 hover:backdrop-blur-md">
              <td class="px-6 py-4 font-semibold">{{ task.taskName }}</td>
              <td class="px-6 py-4 text-gray-200">{{ task.startDate |date }}</td>
              <td class="px-6 py-4 text-gray-200" [ngClass]="task.deadline< today ? 'bg-red-500': 'bg-none'">{{
                task.deadline | date}} </td>
              <td class="px-6 py-4 text-gray-200">{{ task.assignee }}</td>
              <td class="px-6 py-4 text-gray-200">{{ task.clientName }}</td>
              <td class="px-6 py-4 max-w-xs truncate text-gray-300">{{ task.notes }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      @if (taskItems.length === 0) {
      <div class="text-center py-8 text-gray-400">âœ¨ No tasks yet. Add your first project below!</div>
      }
    </div>

    <!-- Add Task Form -->
    <div class="bg-white/10 backdrop-blur-lg border border-white/20 shadow-xl rounded-2xl p-8">
      <h2 class="text-2xl font-bold text-white mb-8">âž• Add New Task</h2>

      <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="relative">
          <input type="text" id="taskName" formControlName="taskName" name="taskName"
            class="peer w-full px-4 pt-5 pb-2 bg-white/10 text-white placeholder-transparent rounded-xl border border-white/30 focus:border-primary-400 focus:ring-2 focus:ring-primary-400/50 transition-all"
            placeholder="Task Name" />
          <label for="taskName"
            class="absolute left-4 top-2 text-gray-300 text-sm transition-all peer-placeholder-shown:top-4 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-sm peer-focus:text-primary-300">
            Task Name *
          </label>
          @if (taskForm.get('taskName')?.invalid && taskForm.get('taskName')?.touched) {
          <p class="text-red-400 text-sm mt-1">âš  Required</p>
          }
        </div>

        <!-- Client Name -->
        <div class="relative">
          <input type="text" id="clientName" formControlName="clientName" name="clientName"
            class="peer w-full px-4 pt-5 pb-2 bg-white/10 text-white placeholder-transparent rounded-xl border border-white/30 focus:border-primary-400 focus:ring-2 focus:ring-primary-400/50 transition-all"
            placeholder="Client Name" />
          <label for="clientName"
            class="absolute left-4 top-2 text-gray-300 text-sm transition-all peer-placeholder-shown:top-4 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-sm peer-focus:text-primary-300">
            Client Name *
          </label>
          @if (taskForm.get('clientName')?.invalid && taskForm.get('clientName')?.touched) {
          <p class="text-red-400 text-sm mt-1">âš  Required</p>
          }
        </div>

        <!-- Dates -->
        <div class="relative">
          <input type="date" id="startDate" formControlName="startDate" name="startDate"
            class="peer w-full px-4 pt-5 pb-2 bg-white/10 text-white rounded-xl border border-white/30 focus:border-primary-400 focus:ring-2 focus:ring-primary-400/50 transition-all" />
          <label for="startDate"
            class="absolute left-4 top-2 text-gray-300 text-sm transition-all peer-focus:text-primary-300">
            Start Date *
          </label>
          @if (taskForm.get('startDate')?.invalid && taskForm.get('startDate')?.touched) {
          <p class="text-red-400 text-sm mt-1">âš  Required</p>
          }
        </div>

        <div class="relative">
          <input type="date" id="deadline" formControlName="deadline" name="deadline" class=" peer w-full px-4 pt-5 pb-2 bg-white/10 text-white rounded-xl border border-white/30
            focus:border-primary-400 focus:ring-2 focus:ring-primary-400/50 transition-all" />
          <label for="deadline"
            class="absolute left-4 top-2 text-gray-300 text-sm transition-all peer-focus:text-primary-300">
            Deadline *
          </label>
          @if (taskForm.get('deadline')?.invalid && taskForm.get('deadline')?.touched) {
          <p class="text-red-400 text-sm mt-1">
            @if (taskForm.get('deadline')?.errors?.['required']) { âš  Required }
            @if (taskForm.get('deadline')?.errors?.['deadlineAfterStart']) { ðŸš« Must be after start date }
          </p>
          }
        </div>

        <div class="relative">
          <input type="text" id="assignee" formControlName="assignee" name="assignee" class=" peer w-full px-4 pt-5 pb-2 bg-white/10 text-white placeholder-transparent rounded-xl border
            border-white/30 focus:border-primary-400 focus:ring-2 focus:ring-primary-400/50 transition-all"
            placeholder="Assignee" />
          <label for="assignee"
            class="absolute left-4 top-2 text-gray-300 text-sm transition-all peer-placeholder-shown:top-4 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-sm peer-focus:text-primary-300">
            Assignee *
          </label>
          @if (taskForm.get('assignee')?.invalid && taskForm.get('assignee')?.touched) {
          <p class="text-red-400 text-sm mt-1">âš  Required</p>
          }
        </div>

        <!-- Notes -->
        <div class="relative md:col-span-2">
          <textarea id="notes" formControlName="notes" rows="4" name="notes"
            class="peer w-full px-4 pt-5 pb-2 bg-white/10 text-white placeholder-transparent rounded-xl border border-white/30 focus:border-primary-400 focus:ring-2 focus:ring-primary-400/50 transition-all resize-none"
            placeholder="Notes"></textarea>
          <label for="notes"
            class="absolute left-4 top-2 text-gray-300 text-sm transition-all peer-placeholder-shown:top-4 peer-placeholder-shown:text-gray-400 peer-placeholder-shown:text-base peer-focus:top-2 peer-focus:text-sm peer-focus:text-primary-300">
            Notes *
          </label>
          @if (taskForm.get('notes')?.invalid && taskForm.get('notes')?.touched) {
          <p class="text-red-400 text-sm mt-1">âš  Required</p>
          }
        </div>

        <!-- Submit -->
        <div class="md:col-span-2 flex justify-end">
          <button type="submit" [disabled]="taskForm.invalid"
            class="px-8 py-3 rounded-xl font-semibold tracking-wide bg-gradient-to-r from-primary-500 to-accent-500 hover:from-primary-400 hover:to-accent-400 disabled:opacity-40 shadow-lg transition-all duration-500">
            Add Task
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
}